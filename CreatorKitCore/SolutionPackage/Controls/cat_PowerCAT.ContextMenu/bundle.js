/*! For license information please see bundle.js.LICENSE.txt */
var pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad;(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{ContextMenu:()=>v});const o=React;var r={0:"center",1:"left",2:"right"},i=void 0;try{i=window}catch(e){}function n(e){if(void 0!==i){var t=e;return t&&t.ownerDocument&&t.ownerDocument.defaultView?t.ownerDocument.defaultView:i}}var a=function(){function e(e,t){this._timeoutIds=null,this._immediateIds=null,this._intervalIds=null,this._animationFrameIds=null,this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._noop=function(){}}return e.prototype.dispose=function(){var e;if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(e in this._timeoutIds)this._timeoutIds.hasOwnProperty(e)&&this.clearTimeout(parseInt(e,10));this._timeoutIds=null}if(this._immediateIds){for(e in this._immediateIds)this._immediateIds.hasOwnProperty(e)&&this.clearImmediate(parseInt(e,10));this._immediateIds=null}if(this._intervalIds){for(e in this._intervalIds)this._intervalIds.hasOwnProperty(e)&&this.clearInterval(parseInt(e,10));this._intervalIds=null}if(this._animationFrameIds){for(e in this._animationFrameIds)this._animationFrameIds.hasOwnProperty(e)&&this.cancelAnimationFrame(parseInt(e,10));this._animationFrameIds=null}},e.prototype.setTimeout=function(e,t){var o=this,r=0;return this._isDisposed||(this._timeoutIds||(this._timeoutIds={}),r=setTimeout((function(){try{o._timeoutIds&&delete o._timeoutIds[r],e.apply(o._parent)}catch(e){o._logError(e)}}),t),this._timeoutIds[r]=!0),r},e.prototype.clearTimeout=function(e){this._timeoutIds&&this._timeoutIds[e]&&(clearTimeout(e),delete this._timeoutIds[e])},e.prototype.setImmediate=function(e,t){var o=this,r=0,i=n(t);return this._isDisposed||(this._immediateIds||(this._immediateIds={}),r=i.setTimeout((function(){try{o._immediateIds&&delete o._immediateIds[r],e.apply(o._parent)}catch(e){o._logError(e)}}),0),this._immediateIds[r]=!0),r},e.prototype.clearImmediate=function(e,t){var o=n(t);this._immediateIds&&this._immediateIds[e]&&(o.clearTimeout(e),delete this._immediateIds[e])},e.prototype.setInterval=function(e,t){var o=this,r=0;return this._isDisposed||(this._intervalIds||(this._intervalIds={}),r=setInterval((function(){try{e.apply(o._parent)}catch(e){o._logError(e)}}),t),this._intervalIds[r]=!0),r},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e])},e.prototype.throttle=function(e,t,o){var r=this;if(this._isDisposed)return this._noop;var i,n,a=t||0,l=!0,s=!0,d=0,u=null;o&&"boolean"==typeof o.leading&&(l=o.leading),o&&"boolean"==typeof o.trailing&&(s=o.trailing);var c=function t(o){var c=Date.now(),m=c-d,h=l?a-m:a;return m>=a&&(!o||l)?(d=c,u&&(r.clearTimeout(u),u=null),i=e.apply(r._parent,n)):null===u&&s&&(u=r.setTimeout(t,h)),i};return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n=e,c(!0)}},e.prototype.debounce=function(e,t,o){var r=this;if(this._isDisposed){var i=function(){};return i.cancel=function(){},i.flush=function(){return null},i.pending=function(){return!1},i}var n,a,l=t||0,s=!1,d=!0,u=null,c=0,m=Date.now(),h=null;o&&"boolean"==typeof o.leading&&(s=o.leading),o&&"boolean"==typeof o.trailing&&(d=o.trailing),o&&"number"==typeof o.maxWait&&!isNaN(o.maxWait)&&(u=o.maxWait);var v=function(e){h&&(r.clearTimeout(h),h=null),m=e},p=function(t){v(t),n=e.apply(r._parent,a)},f=function e(t){var o=Date.now(),i=!1;t&&(s&&o-c>=l&&(i=!0),c=o);var a=o-c,v=l-a,f=o-m,I=!1;return null!==u&&(f>=u&&h?I=!0:v=Math.min(v,u-f)),a>=l||I||i?p(o):null!==h&&t||!d||(h=r.setTimeout(e,v)),n},I=function(){return!!h},_=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a=e,f(!0)};return _.cancel=function(){I()&&v(Date.now())},_.flush=function(){return I()&&p(Date.now()),n},_.pending=I,_},e.prototype.requestAnimationFrame=function(e,t){var o=this,r=0,i=n(t);if(!this._isDisposed){this._animationFrameIds||(this._animationFrameIds={});var a=function(){try{o._animationFrameIds&&delete o._animationFrameIds[r],e.apply(o._parent)}catch(e){o._logError(e)}};r=i.requestAnimationFrame?i.requestAnimationFrame(a):i.setTimeout(a,0),this._animationFrameIds[r]=!0}return r},e.prototype.cancelAnimationFrame=function(e,t){var o=n(t);this._animationFrameIds&&this._animationFrameIds[e]&&(o.cancelAnimationFrame?o.cancelAnimationFrame(e):o.clearTimeout(e),delete this._animationFrameIds[e])},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e)},e}();const l=FluentUIReactv8290;var s=" !important";function d(e){return{id:e,key:e,name:"Item "+e,iconName:"Unknown"}}function u(e,t,o){return e.filter((e=>!e.parentItemKey&&!1!==e.visible)).map((r=>c(e,r,t,o)))}function c(e,t,o,r){var i=e.filter((e=>e.parentItemKey===t.key&&e!==t&&!1!==e.visible)).map((t=>c(e,t,o,r))),n={root:{background:"rgba(255, 255, 255,0)"}},a=t.iconName&&{iconName:t.iconName};if(a&&t.iconColor){var d=t.iconColor;a.styles={root:{color:t.iconColor+s}};var u=(0,l.getColorFromString)(d);if(u){var m=(0,l.getShade)(u,l.Shade.Shade8),h={color:(null==m?void 0:m.str)+s};n.iconHovered=h,n.iconPressed=h,n.iconExpanded=h,n.iconChecked=h,n.iconExpandedHovered=h}}var v={key:t.key,text:t.name,disabled:!1===t.enabled||o,onClick:r,iconOnly:!0===t.iconOnly,iconProps:a,canCheck:void 0!==t.checked,checked:t.checked,data:t,buttonStyles:n};return!0===t.isHeader&&i.length>0?(v.itemType=l.ContextualMenuItemType.Section,v.sectionProps={title:t.name,topDivider:t.topDivider,bottomDivider:t.divider,items:i}):!0===t.isHeader?v.itemType=l.ContextualMenuItemType.Header:!0===t.divider?v.itemType=l.ContextualMenuItemType.Divider:(v.itemType=l.ContextualMenuItemType.Normal,v.subMenuProps=i.length>0?{items:i}:void 0),v}var m=o.memo((e=>{var{items:t,onSelected:r,disabled:i,setFocus:n,themeJSON:s,showChevron:d,tabIndex:c}=e,m=o.useMemo((()=>{try{return s?(0,l.createTheme)(JSON.parse(s)):void 0}catch(e){console.error("Cannot parse theme",e)}}),[s]),v=o.useRef(null),p=function(){var e,t,r=(e=function(){return new a},void 0===(t=o.useRef()).current&&(t.current={value:e()}),t.current.value);return o.useEffect((function(){return function(){return r.dispose()}}),[r]),r}();o.useEffect((()=>{n&&""!==n&&v&&p.requestAnimationFrame((()=>{var e;null===(e=v.current)||void 0===e||e.focus()}))}),[n,v,p]);var f=o.useCallback(((e,t)=>((null==t?void 0:t.canCheck)&&(null==e||e.preventDefault()),r(null==t?void 0:t.data),!0)),[r]),I=o.useMemo((()=>{var e={};if(t&&t.length>0){var o=t[0];e.iconProps={iconName:o.iconName},e.disabled=!0===i,e.text=o.iconOnly?"":o.name,e.onSelect=()=>{r(o)};var n=u(t.slice(1),!0===i,f);return n&&n.length>0&&(e.menuProps={shouldFocusOnContainer:!0,items:n}),e.onRenderMenuIcon=!1===d?()=>null:void 0,e}}),[i,t,f,r,d]);return o.createElement(l.ThemeProvider,{applyTo:"none",theme:m,className:"PowerCATFluentContextMenu"},o.createElement(l.DefaultButton,Object.assign({},I,{styles:h(e,t),componentRef:v,tabIndex:c})))}));function h(e,t){return o.useMemo((()=>{var o,r,i,n,a,l,s,d,u=t&&t.length>0?t[0]:void 0,c=null!==(r=null!==(o=e.iconColor)&&void 0!==o?o:null==u?void 0:u.iconColor)&&void 0!==r?r:e.fontColor,m=e.fontColor,h=null!==(i=e.hoverFontColor)&&void 0!==i?i:m,v=e.fillColor,p=null!==(n=e.hoverFillColor)&&void 0!==n?n:v,f=null!==(s=null!==(l=null!==(a=e.hoverIconColor)&&void 0!==a?a:e.hoverFontColor)&&void 0!==l?l:e.iconColor)&&void 0!==s?s:e.fontColor;return{root:{width:e.width,height:e.height,backgroundColor:v,borderColor:e.borderColor,color:m,borderRadius:e.borderRadius,borderWidth:e.fillColor?1:void 0,borderStyle:e.fillColor?"solid":void 0,fontSize:e.fontSize},rootHovered:{backgroundColor:p,borderColor:e.hoverBorderColor,color:h},rootPressed:{backgroundColor:p,color:h},rootExpanded:{backgroundColor:v,color:m},rootExpandedHovered:{backgroundColor:p,borderColor:e.hoverBorderColor,color:h},icon:{color:c,fontSize:null!==(d=e.iconSize)&&void 0!==d?d:e.fontSize},iconHovered:{color:f},iconExpandedHovered:{color:f},label:{textAlign:e.justify}}}),[t,e.borderColor,e.borderRadius,e.fillColor,e.fontColor,e.fontSize,e.height,e.hoverBorderColor,e.hoverFillColor,e.hoverFontColor,e.hoverIconColor,e.iconColor,e.iconSize,e.justify,e.width])}m.displayName="CanvasContextMenu";class v{constructor(){this.focusKey="",this.onSelect=e=>{e&&e.data&&this.context.parameters.items.openDatasetItem(e.data.getNamedReference())}}init(e,t){this.notifyOutputChanged=t,this.context=e,this.context.mode.trackContainerResize(!0),this.context.parameters.items.paging.setPageSize(500)}updateView(e){var t,i,n=this.context.parameters.InputEvent.raw;n&&this.inputEvent!==n&&n.startsWith("SetFocus")&&(this.focusKey=n);var a=e.parameters.items;(e.updatedProperties.indexOf("dataset")>-1||!this.items)&&(this.items=function(e){if(e.error||void 0===e.paging.totalResultCount)return[d("1"),d("2"),d("3")];var t={};return e.sortedRecordIds.map((o=>{var r,i,n,a,l,s,d,u,c=e.records[o],m=null!==(r=c.getFormattedValue("ItemKey"))&&void 0!==r?r:"";return void 0!==t[m]?(t[m]++,m+="_".concat(t[m])):t[m]=1,{id:c.getRecordId(),key:m,name:c.getFormattedValue("ItemDisplayName"),enabled:null!==(i=c.getValue("ItemEnabled"))&&void 0!==i?i:void 0,iconName:c.getFormattedValue("ItemIconName"),iconColor:c.getFormattedValue("ItemIconColor"),parentItemKey:c.getFormattedValue("ItemParentKey"),iconOnly:null!==(n=c.getValue("ItemIconOnly"))&&void 0!==n?n:void 0,checked:null!==(a=c.getValue("ItemChecked"))&&void 0!==a?a:void 0,visible:null!==(l=c.getValue("ItemVisible"))&&void 0!==l?l:void 0,isHeader:null!==(s=c.getValue("ItemHeader"))&&void 0!==s?s:void 0,topDivider:null!==(d=c.getValue("ItemTopDivider"))&&void 0!==d?d:void 0,divider:null!==(u=c.getValue("ItemDivider"))&&void 0!==u?u:void 0,data:c}}))}(a));var l=parseInt(e.mode.allocatedWidth),s=parseInt(e.mode.allocatedHeight),u=null!==(i=null===(t=e.accessibility)||void 0===t?void 0:t.assignedTabIndex)&&void 0!==i?i:void 0,c=e.parameters.TextAlignment.raw,h={tabIndex:u,width:l,height:s,items:this.items,onSelected:this.onSelect,disabled:e.mode.isControlDisabled,setFocus:this.focusKey,themeJSON:e.parameters.Theme.raw,showChevron:!1!==this.context.parameters.Chevron.raw,iconColor:p(e.parameters.IconColor),iconSize:f(e.parameters.IconSize),hoverIconColor:p(e.parameters.HoverIconColor),fontSize:f(e.parameters.FontSize),fontColor:p(e.parameters.FontColor),hoverFontColor:p(e.parameters.HoverFontColor),borderColor:p(e.parameters.BorderColor),hoverBorderColor:p(e.parameters.HoverBorderColor),borderRadius:p(e.parameters.BorderRadius),fillColor:p(e.parameters.FillColor),hoverFillColor:p(e.parameters.HoverFillColor),justify:r[c]};return o.createElement(m,h)}getOutputs(){return{}}destroy(){}}function p(e){return function(e,t){return e.raw?e.raw:void 0}(e)}function f(e){return e.raw&&e.raw>0?e.raw:void 0}pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad=t})();
if (window.ComponentFramework && window.ComponentFramework.registerControl) {
	ComponentFramework.registerControl('PowerCAT.ContextMenu', pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.ContextMenu);
} else {
	var PowerCAT = PowerCAT || {};
	PowerCAT.ContextMenu = pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad.ContextMenu;
	pcf_tools_652ac3f36e1e4bca82eb3c1dc44e6fad = undefined;
}